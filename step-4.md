# Инициализация Spring Boot приложения

Для того что бы быть уверенным, что проект который разрабатывется, будет работать постоянно и иметь возможность запустить проект без необходимости поднимать серврер на боевых мощностях используются различные подходы к тестированию приложений. [про тестирование](https://habr.com/post/279535/).

В Spring существует свой инструмент для тестирования, [Spring Test](https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-testing.html).

*Всю главу необходимо прочитать и ознакомиться с основными тезисами которые есть в документации.*

Как базовый пример, необходимо протестировать **GreetingController.java** и что бы он вернул нам ожидаемый результат.

```java
package io.github.rmuhamedgaliev;
/*
 * This Java source file was generated by the Gradle 'init' task.
 */

import io.github.rmuhamedgaliev.controller.GreetingController;
import io.github.rmuhamedgaliev.model.Greeting;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.boot.test.mock.mockito.MockBean;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;

import static org.hamcrest.Matchers.is;
import static org.hamcrest.Matchers.notNullValue;
import static org.mockito.BDDMockito.given;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultHandlers.print;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

@RunWith(SpringRunner.class)
@WebMvcTest(GreetingController.class)
public class AppTest {

    @Autowired
    private MockMvc mvc;

    @MockBean
    private GreetingController greetingController;

    @Test
    public void testAppHasAGreeting() throws Exception {
        given(greetingController.greeting("name")).willReturn(new Greeting(0, "Hello, name!"));

        mvc.perform(get("/greeting").param("name", "name")
                .accept(MediaType.APPLICATION_JSON)
                .contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isOk())
                .andDo(print())
                .andExpect(jsonPath("content", notNullValue()))
                .andExpect(jsonPath("content", is("Hello, name!")));
    }
}
```

Так же тесты можно запустить не только по средством IDE, но и посредством `gradle`. Для этого в теримнале напиши:

```bash
./gradlew test
``` 

И получите 

```bash
# rmuhamedgaliev @ MacBook-Pro-Rinat in ~/Projects/personal-finance on git:master x [1:06:51] C:1
$ ./gradlew test
Starting a Gradle Daemon, 1 busy Daemon could not be reused, use --status for details

> Task :test
2018-11-06 01:07:21.839 INFO 32910 --- [ Thread-4] o.s.s.concurrent.ThreadPoolTaskExecutor : Shutting down ExecutorService 'applicationTaskExecutor'

```

Задачи: 

- Написать простой тест на контроллер
  
- Добавить тест который будет заведомо ошибочным и обработать исключительную ситуацию

